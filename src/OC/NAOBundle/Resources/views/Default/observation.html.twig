{% extends 'OCNAOBundle::layout.html.twig' %}

{% block body %}

<div class="row visible-xs">
  <div class="return">
    <a class="btn" onClick="javascript:window.history.go(-1)"><span class="glyphicon glyphicon-arrow-left"></span> RETOUR EN ARRIÈRE.</a>
  </div>
</div>

<div class="observation">
  <div class="container">
    <div class="row hidden-xs">
      <div class="return">
        <a class="btn" onClick="javascript:window.history.go(-1)"><span class="glyphicon glyphicon-arrow-left"></span> RETOUR EN ARRIÈRE.</a>
      </div>
    </div>

    <div class="row-fluid Obs">
      {% if observation.0.notconforme == 1 %}
      <div class="col-xs-12 conformeZone notconformzone">
        <h4 class="bold">L'observation est non conforme :</h4>
        <h5>{{ observation.0.notconformetext }}</h5>
      </div>
      {% endif %}
      <div class="hidden-xs">
        <div class="col-xs-12 obsTitle"> <!-- Titre -->
          <div class="col-xs-6">
            <h3 class="obsTaxref">{{ observation.0.taxrefname }}</h3>
            <h6 class="italic obsFamille"></h6>
          </div>
          <div class="right col-xs-6 changeBtn">
            <a class="btn right changeTaxrefname" role="button">Modifier nom de l'éspece</a>
          </div>
          <div class="changeName hidden">
            <div class="col-xs-4">
              <form class="form-horizontal" action="{{ path('ocnao_changeTaxrefname', {'id': observation.0.id }) }}" method="POST">
                <input class="form-control" type="text" name="taxrefname" data-id='listedesespeces',
      					data-url="/Projet5-OC/web/autocomplete" placeholder="Nouveau nom de l'éspece">
            </div>
            <div class="col-xs-2">
              <input class="btn" type="submit" value="Envoyer">
              </form>
            </div>
          </div>
        </div>
      </div>
      <div class="col-md-6 col-xs-12 noPad"> <!-- observateur -->
        <div class="obsUser col-xs-12">
          <img class="col-xs-1 userIconeObs" src="{{ asset("assets/images/userIcone.png")}}" />
          <p class="col-xs-5 user">{{ observation.0.user.username }}</br><span class="italic"> Observation(s) publiée(s)</span></p>
          <span class="col-xs-5 right">{{ observation.0.dateObs.date|date('d/m/Y') }}</span>
        </div>
        <div class="obsPicture center">
          {% if observation.0.picture.image is defined %}
            <img id="photo" class="photoObservation" src=" {{ asset('uploads/picture/' ~ observation.0.picture.image) }}" alt="Photo de l'observation"/>
          {% endif %}
        </div>
        <div class="center visible-xs"> <!-- Titre -->
          <h2>{{ observation.0.taxrefname }}</h2>
          <h6 class="italic"></h6>
        </div>
      </div>

      <div class="carteObs col-md-6 col-xs-12 noPad">
        <div id="map">
        </div>
        <div class="obsPlace">
          <div class="obsPlaceText">
          </div>
        </div>
      </div>
      {% if observation.0.status == 0 and observation.0.notconforme == 0 %}
      <div class="col-xs-12 conformeZone">
        <div class="conformeZoneBtn center">
          <a class="btn btn-success" href="{{ path('ocnao_validate', {'id': observation.0.id }) }}" role="button">Valider l'observation</a>
          <a class="btn btn-danger notconforme" role="button">Observation non conforme</a>
        </div>
        <div class="notconformzone hidden">
          <h4 class="bold">Indiquez le motif de refus de l'observation:</h4>
          <h5>Vos commentaires seront envoyés par mail et sur l'observation de l'observateur.</h5>
          <form class="form-horizontal" action="{{ path('ocnao_notconforme', {'id': observation.0.id }) }}" method="post">
            <input class="form-control" type="text" name="notconformetext" placeholder="Entrez ici le motif de non conformité."><br>
            <div class="col-xs-12">
              <input class="btn btnSubmitConforme" type="submit" value="Envoyer">
            </div>
          </form>
        </div>
      </div>
      {% endif %}
    </div>
  </div>
</div>


<div id="coordonnees" class="hidden">
    <div data-latitude="{{ observation.0.latitude }}" data-longitude="{{ observation.0.longitude }}" data-username="{{ observation.0.user.username }}"></div>
</div>

<script src="{{asset("assets/js/mapObs.js")}}"></script>
<script src="{{asset("assets/js/autocomplete.js")}}"></script>
<script async defer
  src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCDwjyiE5EGvQcAaJPNkxATWhrxBUsb11A&callback=initMap">
</script>

{% endblock %}
